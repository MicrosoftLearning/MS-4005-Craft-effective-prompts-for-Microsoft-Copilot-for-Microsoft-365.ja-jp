
新しい列の数式の書き方がわからない場合でも、Microsoft 365 Copilot はデータに基づいた数式を使用して新しい列をすぐに追加できます。 

1. データがテーブルとして書式設定されている状態で、リボンの **[Copilot]** ボタンを選択します。

1. **[数式列を追加する]** または **[数式列の候補を表示する]** を選択します。 どのような列を追加するかを説明するのに、自分の言葉を入力することもできます。

1. Copilot は、数式の提案を各数式のしくみの説明とともに提供します。 説明を表示するには、**[数式を説明する]** を選択します。

1. 数式列をテーブルに追加するには、[列の挿入] を選択します。

> [!IMPORTANT]
> AI によって生成されるコンテンツと同様に、Copilot が作成した内容を確認、編集、検証することが重要です。

## 作成方法を見てみましょう

まず、まだ行っていない場合は、**_[Fabrikam Q1 marketing campaigns.xlsx](https://go.microsoft.com/fwlink/?linkid=2269124)_** をダウンロードし、ファイルを **OneDrive フォルダー**に保存します。

Excel でスプレッドシートを開き、リボンの **[ホーム]** タブで Copilot アイコンを選択して **[Copilot]** ペインを開きます。以下のプロンプトを入力し、操作を進めます。

> [!NOTE]
> 開始プロンプト:
>
> _この数式の説明をしてください。_

この簡単なプロンプトで、_Excel の数式の説明をする_という基本的な**目標**から開始します。 しかし、Copilot はどの数式なのかや何がわからないのかを把握していません。

| 要素 | 例 |
| :------ | :------- |
| 基本プロンプト: <br>**目標**から開始 | **_この数式の説明をしてください。_** |
| 適切なプロンプト: <br>**コンテキスト**の追加 | **コンテキスト**を追加すると、数式についてわからないことを Copilot が把握できるようになります。<br><br>「_ユーザー エンゲージメントの計算方法を理解する必要があります。_」 |
| 改善したプロンプト: <br>**ソース**の指定 | このプロンプトの**ソース**は Excel で使用しているテーブルと考えられますが、さらに具体的にすることができます。<br><br>「_Excel スプレッドシートの Table1 テーブルの列 J の...。_」 |
| 最適なプロンプト: <br>明確な**期待**を設定する | 最後に、**期待**を追加すると、数式をどのように説明して欲しいかやどのように嚙み砕いて欲しいかを Copilot が把握できるようになります。<br><br>「_引数や構文など、この数式の段階的で詳細な説明をしてください。投資収益率を決定するのに役立つその他の数式を提案してください。_」 |

> [!NOTE]
> **作成されたプロンプト**:
>
> _Excel スプレッドシートの Table1 テーブルの列 J の数式の説明をしてください。ユーザー エンゲージメントの計算方法を理解する必要があります。引数や構文など、この数式の段階的で詳細な説明をしてください。投資収益率を決定するのに役立つその他の数式を提案してください。_

[![Excel で Copilot を使用して作成されたプロンプトの結果のスクリーンショット。](../media/copilot-explain-formula-results-excel.png)](../media/copilot-explain-formula-results-excel.png#lightbox)

このプロンプトには**目標**、**コンテキスト**、**ソース**、**期待**があるため、Copilot が確かな回答を提供するのに必要なすべての情報が提供されます。

## さらに探索する

これらのプロンプトを開始点として使用します。 コピーするか、必要に応じて修正します。 

- 新しい列で製品あたりの合計コストを計算します。 

- 2022 年の各マーケティング キャンペーンの総利益を計算する列を追加します。 

- 製品発表イベント後の日数を計算する列を追加します。 

詳細については、「[Excel の Copilot を使用して数式列を生成する](https://support.microsoft.com/office/generate-formula-columns-with-copilot-in-excel-d866d926-9791-4e5f-be2a-c6dd9e587a47)」をご覧ください。