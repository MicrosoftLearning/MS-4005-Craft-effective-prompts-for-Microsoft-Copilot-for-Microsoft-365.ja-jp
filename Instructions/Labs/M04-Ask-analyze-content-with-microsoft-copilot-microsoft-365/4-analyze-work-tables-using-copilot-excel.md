# Excel で Microsoft 365 Copilot を使用して、表を分析し、操作する

新しい列の数式の書き方がわからない場合でも、Microsoft 365 Copilot はデータに基づいた数式を使用して新しい列をすぐに追加できます。

1. データがテーブルとして書式設定されている状態で、リボンの **[Copilot]** ボタンを選択します。

1. **[数式列を追加する]** または **[数式列の候補を表示する]** を選択します。 どのような列を追加するかを説明するのに、自分の言葉を入力することもできます。

1. Copilot は、数式の提案を各数式のしくみの説明とともに提供します。 説明を表示するには、**[数式を説明する]** を選択します。

1. 数式列をテーブルに追加するには、[列の挿入] を選択します。

> [!IMPORTANT]
> AI によって生成されるコンテンツと同様に、Copilot が作成した内容を確認、編集、検証することが重要です。

## 作成方法を見てみましょう

まず、まだ行っていない場合は、**_[Fabrikam Q1 marketing campaigns.xlsx](https://go.microsoft.com/fwlink/?linkid=2269124)_** をダウンロードし、ファイルを **OneDrive フォルダー**に保存します。

Excel でスプレッドシートを開き、リボンの **[ホーム]** タブで Copilot アイコンを選択して **[Copilot]** ペインを開きます。以下のプロンプトを入力し、操作を進めます。

> [!NOTE]
> 開始プロンプト:
>
> _数式列を提案してください。_

この簡単なプロンプトで、_新しい数式列を作成する_という基本的な**目標**から開始します。 ただし、数式で計算する必要がある内容を決定するのに十分な詳細がありません。  

| 要素 | 例 |
| :------ | :------- |
| **基本的なプロンプト:** **目標**から開始 | **_数式列を提案してください。_** |
| **適切なプロンプト:** **コンテキスト**の追加 | **コンテキスト**を追加すると、Copilot は数式で計算する必要がある内容を理解できるようになります。 _「J 列で各キャンペーンのエンゲージメント率を決定する。」_ |
| **プロンプトの改善:** **ソースの指定** | このプロンプトの**ソース**は、計算に必要な特定の列です。 _「...'Engaged Users' と 'Total Users Targeted' の値を使用。」_ |
| **最適なプロンプト:** 明確な**期待**の設定 | **期待**を追加すると、Copilot が数式を正しく構成できるようになります。 _「数式が 'Engaged Users' を 'Total Users Targeted' で除算し、結果をパーセンテージとして表示するようにします。」_ |

> [!NOTE]  
> **作成されたプロンプト**:  
>
> _J 列で各キャンペーンのエンゲージメント率を計算するための数式を提案します。'Engaged Users' と 'Total Users Targeted' の値を使用します。数式が 'Engaged Users' を 'Total Users Targeted' で除算し、結果をパーセンテージとして表示するようにします。_  

![Excel で Copilot を使用して作成されたプロンプトの結果のスクリーンショット。](../media/ask_copilot-explain-formula-results-excel.png)

このプロンプトには**目標**、**コンテキスト**、**ソース**、**期待**があるため、Copilot が確かな回答を提供するのに必要なすべての情報が提供されます。

## さらに探索

これらのプロンプトを開始点として使用します。 コピーするか、必要に応じて修正します。

- 新しい列で製品あたりの合計コストを計算します。

- 2022 年の各マーケティング キャンペーンの総利益を計算する列を追加します。

- 製品発表イベント後の日数を計算する列を追加します。

詳細については、「[Excel の Copilot を使用して数式列を生成する](https://support.microsoft.com/office/generate-formula-columns-with-copilot-in-excel-d866d926-9791-4e5f-be2a-c6dd9e587a47)」をご覧ください。
